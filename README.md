# Office Tweaks - CLI инструмент для работы с документами и изображениями

Office Tweaks - это инструмент командной строки для выполнения различных операций с документами и изображениями, таких как конвертация форматов, сжатие изображений и управление файлами.

## Содержание

- [Требования](#требования)
- [Установка и настройка](#установка-и-настройка)
  - [Подготовка виртуального окружения](#подготовка-виртуального-окружения)
  - [Установка зависимостей](#установка-зависимостей)
- [Использование](#использование)
  - [Интерактивный режим](#интерактивный-режим)
  - [Пакетный режим](#пакетный-режим)
- [Поддерживаемые аргументы CLI](#поддерживаемые-аргументы-cli)
  - [Конвертация PDF в DOCX](#конвертация-pdf-в-docx)
  - [Конвертация DOCX в PDF](#конвертация-docx-в-pdf)
  - [Сжатие изображений](#сжатие-изображений)
  - [Удаление файлов](#удаление-файлов)
- [Примеры использования](#примеры-использования)
- [Обработка ошибок](#обработка-ошибок)

## Требования

- Python 3.7 или выше
- pip (менеджер пакетов Python)
- Операционная система: Windows, macOS или Linux

## Установка и настройка

### Подготовка виртуального окружения

Рекомендуется использовать виртуальное окружение для изоляции зависимостей проекта.

#### Windows
```bash
# Создание виртуального окружения
python -m venv venv

# Активация виртуального окружения
venv\Scripts\activate

# Деактивация (когда закончите работу)
deactivate
```

#### macOS/Linux
```bash
# Создание виртуального окружения
python3 -m venv venv

# Активация виртуального окружения
source venv/bin/activate

# Деактивация (когда закончите работу)
deactivate
```

### Установка зависимостей

После активации виртуального окружения установите необходимые зависимости:

```bash
# Установка пакетов из requirements.txt
pip install -r requirements.txt
```

Или установите зависимости вручную:

```bash
pip install argparse
# Добавьте другие зависимости по мере необходимости
```

## Использование

### Интерактивный режим

Интерактивный режим предоставляет удобное меню для выбора операций:

```bash
# Запуск интерактивного режима
python office_tweaks.py

# Или с явным указанием флага
python office_tweaks.py -i
```

В интерактивном режиме вы увидите меню:
```
==================================================
Office Tweaks - Интерактивный режим
==================================================
1. Конвертация PDF в DOCX
2. Конвертация DOCX в PDF
3. Сжатие изображений
4. Удаление файлов
5. Выход
==================================================
```

### Пакетный режим

Пакетный режим позволяет выполнять операции напрямую через аргументы командной строки:

```bash
# Показать справку
python office_tweaks.py --help

# Выполнить операцию
python office_tweaks.py --pdf2docx "document.pdf"
```

## Поддерживаемые аргументы CLI

### Конвертация PDF в DOCX

```bash
# Конвертация одного файла
python office_tweaks.py --pdf2docx "C:\path\to\file.pdf"

# Конвертация всех файлов в папке
python office_tweaks.py --pdf2docx all --workdir "C:\path\to\folder"
```

### Конвертация DOCX в PDF

```bash
# Конвертация одного файла
python office_tweaks.py --docx2pdf "C:\path\to\file.docx"

# Конвертация всех файлов в папке
python office_tweaks.py --docx2pdf all --workdir "C:\path\to\folder"
```

### Сжатие изображений

```bash
# Сжатие одного изображения с указанием качества
python office_tweaks.py --compress-images "C:\image.jpg" --quality 60

# Сжатие всех изображений в папке
python office_tweaks.py --compress-images all --workdir "C:\Pictures" --quality 85
```

### Удаление файлов

```bash
# Удаление по расширению
python office_tweaks.py --delete --delete-mode extension --delete-pattern docx --delete-dir "C:\Temp"

# Удаление по подстроке в начале имени
python office_tweaks.py --delete --delete-mode startswith --delete-pattern "temp_" --delete-dir "C:\Temp"

# Удаление по содержанию подстроки в имени
python office_tweaks.py --delete --delete-mode contains --delete-pattern "backup" --delete-dir "C:\Temp"

# Удаление по регулярному выражению
python office_tweaks.py --delete --delete-mode regex --delete-pattern ".*\\.tmp$" --delete-dir "C:\Temp"
```

## Примеры использования

### Пример 1: Пакетная конвертация PDF в DOCX

```bash
# Конвертировать все PDF файлы в папке "Документы" в формат DOCX
python office_tweaks.py --pdf2docx all --workdir "C:\Users\Имя\Документы"
```

### Пример 2: Сжатие фотографий для веб-сайта

```bash
# Сжать все JPG файлы в папке "Фотографии" с качеством 75%
python office_tweaks.py --compress-images all --workdir "C:\Users\Имя\Фотографии" --quality 75
```

### Пример 3: Очистка временных файлов

```bash
# Удалить все временные файлы с расширением .tmp
python office_tweaks.py --delete --delete-mode extension --delete-pattern "tmp" --delete-dir "C:\Temp"
```

### Пример 4: Смешанные операции (несколько шагов)

```bash
# Шаг 1: Конвертировать DOCX в PDF
python office_tweaks.py --docx2pdf all --workdir "C:\Reports"

# Шаг 2: Удалить исходные DOCX файлы
python office_tweaks.py --delete --delete-mode extension --delete-pattern "docx" --delete-dir "C:\Reports"
```

## Обработка ошибок

Программа включает следующие проверки и обработку ошибок:

1. **Проверка существования файлов/директорий** - программа проверяет существование указанных путей перед выполнением операций
2. **Валидация параметров** - проверка корректности значений (например, качество сжатия 1-100)
3. **Взаимоисключающие операции** - нельзя одновременно выполнять несколько операций
4. **Обязательные параметры** - проверка наличия необходимых аргументов для выбранной операции

Пример сообщений об ошибках:
- `Ошибка: Для режима 'all' необходимо указать --workdir`
- `Файл не найден: C:\несуществующий\файл.pdf`
- `Ошибка аргументов: аргумент --pdf2docx: недопустимый выбор`

## Примечания

1. При работе с путями в Windows используйте двойные обратные слеши или сырые строки
2. Для операций с "all" всегда указывайте параметр `--workdir`
3. Качество сжатия изображений должно быть в диапазоне 1-100
4. Программа поддерживает относительные и абсолютные пути
5. В интерактивном режиме доступен пошаговый выбор параметров операции

## Лицензия

[Укажите информацию о лицензии]

## Поддержка

Для получения помощи или сообщения о проблемах:
1. Проверьте правильность синтаксиса команд
2. Убедитесь, что указанные файлы и директории существуют
3. Проверьте, что у вас есть права на чтение/запись
4. Используйте `--help` для просмотра справки по аргументам
